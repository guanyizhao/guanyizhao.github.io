<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>时间序列的平稳性检验 | 赵冠一的博客</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="时间序列的平稳性检验" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="允许自己偶尔做一个自由而无用的灵魂。" />
<meta property="og:description" content="允许自己偶尔做一个自由而无用的灵魂。" />
<link rel="canonical" href="http://localhost:4000/docs/2019-05-13-time-series-stationary-testing.html" />
<meta property="og:url" content="http://localhost:4000/docs/2019-05-13-time-series-stationary-testing.html" />
<meta property="og:site_name" content="赵冠一的博客" />
<script type="application/ld+json">
{"description":"允许自己偶尔做一个自由而无用的灵魂。","@type":"WebPage","url":"http://localhost:4000/docs/2019-05-13-time-series-stationary-testing.html","headline":"时间序列的平稳性检验","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=9d72b7f622b6a90126a83f7b60d920a98fae9dba">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/guanyizhao/myblog">View On GitHub</a></li>
          
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>赵冠一的博客</h1>
          <p>允许自己偶尔做一个自由而无用的灵魂。</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/guanyizhao">guanyizhao</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/mattgraham">mattgraham</a></span>
        </div>

        <ul id="markdown-toc">
  <li><a href="#时间序列的平稳性检验" id="markdown-toc-时间序列的平稳性检验">时间序列的平稳性检验</a>    <ul>
      <li><a href="#一单位根过程" id="markdown-toc-一单位根过程">一、单位根过程</a>        <ul>
          <li><a href="#11-定义" id="markdown-toc-11-定义">1.1 定义</a></li>
          <li><a href="#12-单位根过程与平稳过程的关系" id="markdown-toc-12-单位根过程与平稳过程的关系">1.2 单位根过程与平稳过程的关系</a></li>
        </ul>
      </li>
      <li><a href="#二单位根过程的假设检验" id="markdown-toc-二单位根过程的假设检验">二、单位根过程的假设检验</a>        <ul>
          <li><a href="#21-迪基-福勒检验法" id="markdown-toc-21-迪基-福勒检验法">2.1 迪基-福勒检验法</a></li>
        </ul>
      </li>
      <li><a href="#references" id="markdown-toc-references">References</a></li>
    </ul>
  </li>
</ul>

<p><a href="../">回到上一级</a></p>

<hr />

<h1 id="时间序列的平稳性检验">时间序列的平稳性检验</h1>

<hr />

<h2 id="一单位根过程">一、单位根过程</h2>

<h3 id="11-定义">1.1 定义</h3>

<p><a href="https://zh.wikipedia.org/wiki/平稳过程">平稳过程</a>分为严（强）平稳过程和宽（弱）平稳过程。一般意义上更常用的是宽平稳过程。</p>

<p>宽平稳过程指的是序列的一阶和二阶矩不随时间变化，即</p>

<script type="math/tex; mode=display">E(x_t) = \mu</script>

<script type="math/tex; mode=display">E(x_{t_1}, x_{t_2}) = R_x(t_1, t_2) = R_x(\tau, 0), \tau = t_2 - t_1</script>

<p><a href="https://wenku.baidu.com/view/584fa090ad51f01dc281f176.html">单位根过程</a>指的是对某一随机过程$y_t$，若</p>

<script type="math/tex; mode=display">y_t = \rho y_{t-1} + u_t</script>

<p>其中，$\rho = 1$，且${u_t}$为一平稳过程，满足$E(u_t)=0$，$cov(u_t, u_{t-s})=r_s &lt; \infty$，则称$y_t$为单位根过程。</p>

<h3 id="12-单位根过程与平稳过程的关系">1.2 单位根过程与平稳过程的关系</h3>

<p>单位根过程是非平稳过程。</p>

<p>考虑上述单位根过程，即$\rho = 1$且${u_t}$平稳：</p>

<script type="math/tex; mode=display">y_t = y_{t-1} + u_t</script>

<p>则有</p>

<script type="math/tex; mode=display">y_t = y_0 + \sum_{i=1}^{t} u_i</script>

<p>故此，$y_t$的期望为：</p>

<script type="math/tex; mode=display">E(y_t) = y_0 + t E(u_i) = y_0</script>

<p>方差为：</p>

<script type="math/tex; mode=display">D(y_t) = D(\sum_{i=1}^{t} u_i) = E[\sum_{i=1}^{t} u_i - E(\sum_{i=1}^{t} u_i)]^2 = E(\sum_{i=1}^{t} u_i)^2 \\
= t r_0 + 2(t-1)r_1 + 2(t-2)r_2 + \cdots + 2r_{t-1}</script>

<p>同理，协方差为：</p>

<script type="math/tex; mode=display">cov(y_t, y_{t-s}) = E[y_t - E(y_t)][y_{t-s} - E(y_{t-s})] = E(\sum_{i=1}^{t} u_t)(\sum_{i=1}^{t-s} u_{t-s}) \\
= (t-s)r_0 + [2(t-s)-1]r_1 + [2(t-s)-2]r_2 + \cdots + 2r_{t-s-1} + r_{t-s} + \cdots + r_{t-1}</script>

<p>可见$y_t$的协方差不仅与$s$有关，也与$t$自身有关，因此$y_t$不是平稳过程。</p>

<p>（上述公式为笔者自推，若有谬误，恳请原谅）</p>

<hr />

<h2 id="二单位根过程的假设检验">二、单位根过程的假设检验</h2>

<p>既然单位根过程是非平稳过程，我们只需检验检验时间序列是单位根过程，即可排除该序列是平稳序列的可能，反之则该序列有可能是平稳序列。</p>

<h3 id="21-迪基-福勒检验法">2.1 迪基-福勒检验法</h3>
<p>检验序列是否存在单位根的检验被称为<a href="https://baike.baidu.com/item/单位根检验/5574482?fr=aladdin">单位根检验</a>，通常使用<a href="https://en.wikipedia.org/wiki/Dickey–Fuller_test">迪基-福勒检验法(Dickey-Fuller test)</a>或<a href="https://en.wikipedia.org/wiki/Augmented_Dickey–Fuller_test">扩展的迪基-福勒检验法(Augmented Dickey-Fuller test)</a>进行检验（Matlab对应的函数为<a href="https://www.mathworks.com/help/econ/adftest.html">adftest</a>)。扩展的迪基-福勒检验法即将后面所讲的差分后所得的自回归模型AR(1)扩展到AR(p)，此处仅讨论基本的迪基-福勒检验法。</p>

<p>DF检验一般考虑差分信号，即对$y_t = \rho y_{t-1} + u_t$差分，得：</p>

<script type="math/tex; mode=display">y_t - y_{t - 1} = \Delta y_t = (\rho - 1) y_{t-1} + u_t = \delta y_{t-1} + u_t</script>

<p>上式为最一般的检测模型，若考虑到偏移项和时间趋势项则上述式子需要进行相应的更改，一般考虑以下三种模型：</p>

<ul>
  <li>初始模型（在Matlab-adftest中参数<code class="highlighter-rouge">'model'</code>取<code class="highlighter-rouge">‘AR'</code>，为默认情况），对应零均值平稳序列</li>
</ul>

<script type="math/tex; mode=display">\Delta y_t = \delta y_{t-1} + u_t</script>

<ul>
  <li>含偏移项（在Matlab-adftest中参数<code class="highlighter-rouge">'model'</code>取<code class="highlighter-rouge">‘ARD'</code>），对应任意均值平稳序列</li>
</ul>

<script type="math/tex; mode=display">\Delta y_t = a_0 + \delta y_{t-1} + u_t</script>

<ul>
  <li>含偏移项和时间趋势项（在Matlab-adftest中参数<code class="highlighter-rouge">'model'</code>取<code class="highlighter-rouge">‘TS'</code>），对应趋势平稳序列</li>
</ul>

<script type="math/tex; mode=display">\Delta y_t = a_0 + a_1 t + \delta y_{t-1} + u_t</script>

<p>考虑上述数学模型，若$\delta = 0$则可得$\rho = 1$，即序列中存在单位根。因此，取原假设为存在单位根，即$\delta = 1$；相应的，备择假设为不存在单位根。</p>

<p>具体的检验统计量由t-统计量和F-统计量执行，在Matlab-adftest中可以通过设置<code class="highlighter-rouge">'test'</code>对应的参数来选择具体的检验统计量，备选值有<code class="highlighter-rouge">'t1'</code>、<code class="highlighter-rouge">'t2'</code>、<code class="highlighter-rouge">'F'</code>，注意，当模型为<code class="highlighter-rouge">'AR'</code>时，无法选择F-统计量<code class="highlighter-rouge">'F'</code>，F-检验除了判断$\delta = 0$是否成立外还检验$a_0=0$和$a_1=0$的取值。</p>

<p>在Matlab中，若adftest返回<code class="highlighter-rouge">h = 1</code>则表示该检验拒绝了原假设，接受备择假设，也就是说所检测的序列不含单位根，那么该序列平稳且将向均值回归；相应的，若adftest返回<code class="highlighter-rouge">h = 0</code>则表示该检验无法拒绝原假设，也就是说所检测的序列含有单位根，不是平稳序列。</p>

<hr />

<h2 id="references">References</h2>

<p><a href="https://wenku.baidu.com/view/584fa090ad51f01dc281f176.html">单位根检验-百度文库</a></p>

<p><a href="https://en.wikipedia.org/wiki/Dickey–Fuller_test">迪基-福勒检验法-wikipedia</a></p>

<p><a href="https://en.wikipedia.org/wiki/Augmented_Dickey–Fuller_test">扩展的迪基-福勒检测法-wikipedia</a></p>

<p><a href="https://www.mathworks.com/help/econ/adftest.html">扩展的迪基-福勒检测法-Matlab帮助文档</a></p>

<hr />

<p><a href="../">回到上一级</a></p>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



      </section>

    </div>

    
  </body>
</html>
